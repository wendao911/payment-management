# Contracts 合同管理组件

## 目录结构

```
Contracts/
├── index.js                      # 主入口文件
├── Contracts.js                  # 主要组件（页面编排）
├── components/                   # 子组件
│   ├── SearchForm.js             # 查询表单
│   ├── ContractsTable.js         # 合同列表表格
│   ├── ContractFormModal.js      # 合同新增/编辑模态框
│   └── ContractDetailModal.js    # 合同详情弹窗（含附件）
├── hooks/
│   └── useContracts.js           # 数据获取与业务逻辑 Hook
├── styles/
│   └── index.js                  # 样式（CSS-in-JS）
└── README.md
```

## 优化内容

### 1. 代码拆分
- 将原来的单文件组件拆分为多个小组件
- 每个组件职责单一，便于维护和测试
- 使用自定义 Hooks 管理状态和业务逻辑

### 2. 用户体验优化
- 添加保存/更新时的加载状态
- 按钮在提交时显示加载动画
- 成功/失败操作的 Toast 提示
- 删除操作时的确认对话框和进度反馈

### 3. 组件化设计
- **SearchForm**: 搜索表单组件，支持多条件查询
- **ContractsTable**: 合同列表表格组件，包含分页和操作按钮
- **ContractFormModal**: 合同新增/编辑模态框组件
- **ContractDetailModal**: 合同详情弹窗组件，支持附件管理

### 4. 自定义 Hooks
- **useContracts**: 合同数据管理，包含增删改查逻辑
- 封装了数据预处理、树形结构转换等业务逻辑

### 5. 样式优化
- 统一的表格样式
- 响应式布局设计
- 美观的查询表单样式
- 一致的颜色主题

### 6. 错误处理
- 完善的错误提示机制
- 网络请求失败时的用户友好提示
- 表单验证错误处理

## 使用方法

```jsx
import Contracts from './pages/Contracts';

// 在路由中使用
<Route path="/contracts" element={<Contracts />} />
```

## 主要功能

- 合同列表展示
- 合同信息搜索
- 新增合同
- 编辑合同信息
- 删除合同
- 合同详情查看
- 附件管理
- 分页显示
- 响应式设计

## 技术特点

- 使用 React Hooks 管理状态
- 自定义 Hooks 封装业务逻辑
- Ant Design 组件库
- 模块化 CSS 样式
- 错误边界处理
- 性能优化

## 搜索功能

支持按以下条件搜索：
- 合同编号
- 合同标题
- 供应商
- 状态（激活/非激活）
- 合同日期范围

## 表单验证

### 合同表单
- 合同编号：必填
- 合同标题：必填
- 合同描述：可选
- 供应商：必选
- 状态：必选
- 父合同：可选
- 合同日期：可选
- 开始日期：可选
- 结束日期：可选

## 数据字段

### 合同
- **ContractNumber**: 合同编号
- **Title**: 合同标题
- **Description**: 合同描述
- **ContractDate**: 合同日期
- **StartDate**: 开始日期
- **EndDate**: 结束日期
- **Status**: 状态
- **SupplierId**: 供应商ID
- **ParentContractId**: 父合同ID

## 表格特性

- 分页功能
- 排序功能
- 响应式列宽
- 操作按钮（详情、编辑、删除）

## 模态框功能

- 合同新增/编辑
- 合同详情查看
- 表单验证
- 加载状态
- 成功/失败反馈

## 状态管理

- 合同数据状态
- 搜索过滤状态
- 模态框显示状态
- 编辑状态
- 加载状态

## 性能优化

- 使用 useCallback 优化函数引用
- 合理的依赖数组设置
- 组件拆分减少重渲染
- 样式文件集中管理

## 错误处理

- API 请求错误处理
- 表单验证错误提示
- 网络连接错误提示
- 用户友好的错误信息

## 响应式设计

- 移动端适配
- 表格列宽自适应
- 搜索表单响应式布局
- 模态框尺寸适配
